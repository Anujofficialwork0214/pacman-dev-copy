<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />
    <meta name="theme-color" content="#000000" />
    <title>Pacman - Android</title>
    
    <!-- App Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjMDAwMDAwIi8+CjxjaXJjbGUgY3g9IjE2IiBjeT0iMTYiIHI9IjEyIiBmaWxsPSIjRkZGRjAwIi8+CjxjaXJjbGUgY3g9IjE2IiBjeT0iMTIiIHI9IjIiIGZpbGw9IiMwMDAwMDAiLz4KPHBhdGggZD0iTTE2IDE2IEwyNCA4IEwxNiAxNiBMMTYgMjQiIGZpbGw9IiMwMDAwMDAiLz4KPC9zdmc+">
    <link rel="icon" type="image/png" sizes="16x16" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSIjMDAwMDAwIi8+CjxjaXJjbGUgY3g9IjgiIGN5PSI4IiByPSI2IiBmaWxsPSIjRkZGRjAwIi8+CjxjaXJjbGUgY3g9IjgiIGN5PSI2IiByPSIxIiBmaWxsPSIjMDAwMDAwIi8+CjxwYXRoIGQ9Ik04IDggTDEyIDQgTDggOCBMOCAxMiIgZmlsbD0iIzAwMDAwMCIvPgo8L3N2Zz4=">
    <link rel="apple-touch-icon" sizes="180x180" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiBmaWxsPSIjMDAwMDAwIi8+CjxjaXJjbGUgY3g9IjkwIiBjeT0iOTAiIHI9IjcwIiBmaWxsPSIjRkZGRjAwIi8+CjxjaXJjbGUgY3g9IjkwIiBjeT0iNjAiIHI9IjEwIiBmaWxsPSIjMDAwMDAwIi8+CjxwYXRoIGQ9Ik05MCA5MCBMMTQwIDQwIEw5MCA5MCBMOTAgMTQwIiBmaWxsPSIjMDAwMDAwIi8+Cjwvc3ZnPg==">
    <link rel="shortcut icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjMDAwMDAwIi8+CjxjaXJjbGUgY3g9IjE2IiBjeT0iMTYiIHI9IjEyIiBmaWxsPSIjRkZGRjAwIi8+CjxjaXJjbGUgY3g9IjE2IiBjeT0iMTIiIHI9IjIiIGZpbGw9IiMwMDAwMDAiLz4KPHBhdGggZD0iTTE2IDE2IEwyNCA4IEwxNiAxNiBMMTYgMjQiIGZpbGw9IiMwMDAwMDAiLz4KPC9zdmc+">
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Permanent+Marker" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- Splash Screen -->
    <div id="splash" style="position:fixed;inset:0;background:#000;display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:1000;color:#0ff;font-family:'Permanent Marker', cursive;">
      <div style="font-size:28px;margin-bottom:8px;">PACMAN</div>
      <div style="font-size:14px;color:#9ff">Loading‚Ä¶</div>
      <div id="splash-dots" style="margin-top:10px;color:#6ff">‚óè ‚óè ‚óè</div>
    </div>

    <!-- Home Screen (shown before game start) -->
    <div id="home" style="position:fixed;inset:0;background:linear-gradient(180deg,#030303,#0a0a0a);display:none;align-items:center;justify-content:center;z-index:900;">
      <div style="width:92%;max-width:520px;border-radius:12px;background:#111;padding:16px;border:1px solid #0a3;box-shadow:0 0 24px rgba(0,255,170,.15);text-align:center;color:#eafffb;">
        <div style="font-family:'Permanent Marker', cursive;font-size:26px;letter-spacing:1px;color:#35f7c6;margin-bottom:6px;">Pacman</div>
        <div style="font-size:12px;color:#9ad;opacity:.9;margin-bottom:14px;">Modern Smartphone Edition</div>
        <button id="btnStartGame" style="width:100%;padding:12px 10px;margin:6px 0;background:linear-gradient(90deg,#00ffaa,#00ccff);border:none;border-radius:8px;color:#001;font-weight:700;letter-spacing:.5px;">START GAME</button>
        <button id="btnHelp" style="width:100%;padding:10px;margin:6px 0;background:#0d2230;border:1px solid #0aa;border-radius:8px;color:#bfe8ff;">HELP</button>
      </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" style="position:fixed;inset:0;background:rgba(0,0,0,.75);display:none;align-items:center;justify-content:center;z-index:950;">
      <div style="width:92%;max-width:560px;background:#0b1116;border:1px solid #0aa;border-radius:10px;color:#d9f7ff;padding:14px;">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;">
          <div style="font-weight:700;color:#6df;">How to Play</div>
          <button id="btnCloseHelp" style="background:#07202c;color:#9ad;border:1px solid #0aa;border-radius:6px;padding:6px 10px;">Close</button>
        </div>
        <ul style="margin:0;padding-left:18px;line-height:1.6;color:#bfe8ff;text-align:left;">
          <li>Use on‚Äëscreen arrows to move Pacman.</li>
          <li>Eat all biscuits to clear the level; pills make ghosts vulnerable.</li>
          <li>Start button begins a new game; Sound toggles audio.</li>
          <li>Pause button pauses/resumes gameplay.</li>
        </ul>
      </div>
    </div>
    <div id="shim">shim for font face</div>
    <h1>üéÆ Pacman - Android</h1>
    <p id="instructions">
      Use touch controls to play
    </p>

    <!-- Game Wrapper -->
    <div class="game-wrapper">
      <div id="pacman" aria-label="Pacman Canvas Wrapper"></div>
    </div>

    <!-- Mobile Controls -->
    <div class="controls" aria-label="Mobile Controls">
      <div class="controls-row">
        <button class="ctrl-btn btn-up" data-key="38" aria-label="Up">‚ñ≤</button>
      </div>
      <div class="controls-row">
        <button class="pill-btn" data-key="80" aria-label="Pause/Resume (P)">‚è∏ Pause</button>
        <button class="ctrl-btn btn-start" data-key="78" aria-label="Start (N)">START</button>
        <button class="pill-btn sound-btn" data-key="83" aria-label="Toggle Sound (S)">üîä Sound</button>
      </div>
      <div class="controls-row">
        <button class="ctrl-btn btn-left" data-key="37" aria-label="Left">‚óÄ</button>
        <button class="ctrl-btn btn-down" data-key="40" aria-label="Down">‚ñº</button>
        <button class="ctrl-btn btn-right" data-key="39" aria-label="Right">‚ñ∂</button>
      </div>
    </div>

    <script src="jiogames_sp_wrapper.js" type="text/javascript"></script>
    <script>
        // Console logging for smartphone SDK
        console.log("Pacman - Smartphone SDK initialized");
        window.addEventListener('load', function() {
            console.log("Pacman Smartphone - Page Loaded");
          // Hide splash after a short delay, then show home
          setTimeout(function(){
            var s=document.getElementById('splash'); if(s){ s.style.display='none'; }
            var h=document.getElementById('home'); if(h){ h.style.display='flex'; }
          }, 1200);
            
            // JioGames SDK Integration - Get user profile on game load
            setTimeout(function() {
                if (typeof getUserProfile === 'function') {
                    getUserProfile();
                    console.log("Pacman: User profile requested");
                }
                
                // Cache ads with 5 second delay between them
                if (typeof gameCacheAd === 'function') {
                    gameCacheAd();
                    console.log("Pacman: Ads caching started");
                }
            }, 1000);
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" type="text/javascript"></script>
    <script src="./app.js" type="text/javascript"></script>

    <!-- Touch/Click Controls Script -->
    <script>
      (function() {
        function fireKey(code) {
          try {
            const ev = new KeyboardEvent('keydown', {bubbles: true, cancelable: true, keyCode: code, which: code});
            Object.defineProperty(ev, 'keyCode', {get: function(){return code;}});
            Object.defineProperty(ev, 'which', {get: function(){return code;}});
            document.dispatchEvent(ev);
          } catch (e) {
            // Fallback for older browsers
            const ev = document.createEvent('Event');
            ev.initEvent('keydown', true, true);
            ev.keyCode = code;
            ev.which = code;
            document.dispatchEvent(ev);
          }
        }

        // handle tap & press-and-hold to repeat
        let repeatTimer = null;
        const REPEAT_MS = 120; // Faster response for smartphones

        function startRepeat(code) {
          fireKey(code);
          clearInterval(repeatTimer);
          repeatTimer = setInterval(function(){ fireKey(code); }, REPEAT_MS);
        }
        function stopRepeat() {
          clearInterval(repeatTimer);
          repeatTimer = null;
        }

        function bindBtn(btn) {
          const code = parseInt(btn.getAttribute('data-key'), 10);
          // Mouse
          btn.addEventListener('mousedown', function(){ startRepeat(code); });
          btn.addEventListener('mouseup', stopRepeat);
          btn.addEventListener('mouseleave', stopRepeat);
          btn.addEventListener('click', function(e){ e.preventDefault(); });
          // Touch (better for Android)
          btn.addEventListener('touchstart', function(e){ 
            e.preventDefault(); 
            startRepeat(code);
            // Haptic feedback for Android
            if (navigator.vibrate) {
              navigator.vibrate(10);
            }
          }, {passive:false});
          btn.addEventListener('touchend', function(e){ e.preventDefault(); stopRepeat(); }, {passive:false});
          btn.addEventListener('touchcancel', stopRepeat, {passive:true});
        }

        document.addEventListener('DOMContentLoaded', function(){
          document.querySelectorAll('.ctrl-btn, .pill-btn').forEach(bindBtn);
          // Home screen bindings
          var hs=document.getElementById('home');
          var btnStart=document.getElementById('btnStartGame');
          var btnHelp=document.getElementById('btnHelp');
          var help=document.getElementById('helpModal');
          var btnClose=document.getElementById('btnCloseHelp');
          function fireKey(code){
            try{const ev=new KeyboardEvent('keydown',{bubbles:true,cancelable:true,keyCode:code,which:code});
              Object.defineProperty(ev,'keyCode',{get:function(){return code;}});
              Object.defineProperty(ev,'which',{get:function(){return code;}});
              document.dispatchEvent(ev);
            }catch(e){}
          }
          if(btnStart){ btnStart.addEventListener('click',function(){
            if(hs){ hs.style.display='none'; }
            // Optionally try to show an ad on start if ready
            try{ if(typeof gameCacheAd==='function'){ gameCacheAd(); } }catch(e){}
            setTimeout(function(){ fireKey(78); }, 150); // 'N' to start
          }); }
          if(btnHelp){ btnHelp.addEventListener('click',function(){ if(help){ help.style.display='flex'; } }); }
          if(btnClose){ btnClose.addEventListener('click',function(){ if(help){ help.style.display='none'; } }); }
          
          // Sound button icon toggle logic
          const soundBtn = document.querySelector('.sound-btn');
          if (soundBtn) {
            // Initial state check
            function updateSoundIcon() {
              const isSoundDisabled = localStorage["soundDisabled"] === "true";
              soundBtn.innerHTML = isSoundDisabled ? 'üîá Sound' : 'üîä Sound';
            }
            
            // Update icon on click and keypress
            soundBtn.addEventListener('click', function() {
              setTimeout(updateSoundIcon, 150); // Wait for localStorage to update
            });
            
            // Listen for 'S' key press to update icon
            document.addEventListener('keydown', function(e) {
              if (e.keyCode === 83) { // 'S' key
                setTimeout(updateSoundIcon, 150);
              }
            });
            
            // Set initial state
            updateSoundIcon();
            
            // Refresh icon every second to ensure sync
            setInterval(updateSoundIcon, 1000);
          }
        });
      })();
    </script>
  </body>
</html>


